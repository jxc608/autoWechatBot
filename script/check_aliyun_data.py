# coding=utf-8
import init_django
from wechat_server.dealMsg.wechatManager import get_aliyun_pic_info


def go(result):
    room_data = get_aliyun_pic_info(result)
    print(room_data)
    print('error: %s' % scanError(room_data))


def scanError(room_data):
    total_score = 0
    for playerData in room_data.playerData:
        total_score += playerData.score
    erro_msg = ""
    if room_data.startTime == '' or room_data.roomId == 0 or total_score != 0 \
            or room_data.roundCounter == 0 or len(room_data.playerData) == 0 or len(room_data.playerData) > 9:
        erro_msg = '图片无法识别\n'
        erro_msg += 'roomId:%s\n' % room_data.roomId
        erro_msg += 'startTime:%s\n' % room_data.startTime
        erro_msg += 'roomHosterId:%s\n' % room_data.roomHosterId
        erro_msg += 'roomHoster:%s\n' % room_data.roomHoster
        erro_msg += 'roundCounter:%s\n' % room_data.roundCounter
        erro_msg += 'players:%s\n' % len(room_data.playerData)
        erro_msg += 'total_score:%s' % total_score

    return erro_msg


if __name__ == '__main__':
    result = {
        "sid": "xxxxx",
        "angle": 0,
        "height": 1136,
        "width": 640,
        "prism_wordsInfo": [
            {
                "pos": [
                    {
                        "x": 361,
                        "y": 1027
                    },
                    {
                        "x": 559,
                        "y": 1027
                    },
                    {
                        "x": 559,
                        "y": 1052
                    },
                    {
                        "x": 361,
                        "y": 1052
                    }
                ],
                "prob": 99,
                "word": "俞房号：204324"
            },
            {
                "pos": [
                    {
                        "x": 615,
                        "y": 1027
                    },
                    {
                        "x": 893,
                        "y": 1027
                    },
                    {
                        "x": 893,
                        "y": 1052
                    },
                    {
                        "x": 615,
                        "y": 1052
                    }
                ],
                "prob": 99,
                "word": "国房主：梦想就在前方"
            },
            {
                "pos": [
                    {
                        "x": 361,
                        "y": 1082
                    },
                    {
                        "x": 499,
                        "y": 1082
                    },
                    {
                        "x": 499,
                        "y": 1106
                    },
                    {
                        "x": 361,
                        "y": 1106
                    }
                ],
                "prob": 99,
                "word": "局数：10"
            },
            {
                "pos": [
                    {
                        "x": 612,
                        "y": 1082
                    },
                    {
                        "x": 644,
                        "y": 1082
                    },
                    {
                        "x": 644,
                        "y": 1106
                    },
                    {
                        "x": 612,
                        "y": 1106
                    }
                ],
                "prob": 90,
                "word": "仑"
            },
            {
                "pos": [
                    {
                        "x": 657,
                        "y": 1081
                    },
                    {
                        "x": 870,
                        "y": 1081
                    },
                    {
                        "x": 870,
                        "y": 1106
                    },
                    {
                        "x": 657,
                        "y": 1106
                    }
                ],
                "prob": 95,
                "word": "时间：042413：40"
            },
            {
                "pos": [
                    {
                        "x": 338,
                        "y": 1130
                    },
                    {
                        "x": 402,
                        "y": 1130
                    },
                    {
                        "x": 402,
                        "y": 1156
                    },
                    {
                        "x": 338,
                        "y": 1156
                    }
                ],
                "prob": 99,
                "word": "玩家"
            },
            {
                "pos": [
                    {
                        "x": 685,
                        "y": 1131
                    },
                    {
                        "x": 718,
                        "y": 1131
                    },
                    {
                        "x": 718,
                        "y": 1154
                    },
                    {
                        "x": 685,
                        "y": 1154
                    }
                ],
                "prob": 83,
                "word": "1D"
            },
            {
                "pos": [
                    {
                        "x": 815,
                        "y": 1128
                    },
                    {
                        "x": 876,
                        "y": 1128
                    },
                    {
                        "x": 876,
                        "y": 1156
                    },
                    {
                        "x": 815,
                        "y": 1156
                    }
                ],
                "prob": 99,
                "word": "积分"
            },
            {
                "pos": [
                    {
                        "x": 413,
                        "y": 1190
                    },
                    {
                        "x": 493,
                        "y": 1195
                    },
                    {
                        "x": 491,
                        "y": 1218
                    },
                    {
                        "x": 412,
                        "y": 1213
                    }
                ],
                "prob": 99,
                "word": "eloy ya"
            },
            {
                "pos": [
                    {
                        "x": 690,
                        "y": 1190
                    },
                    {
                        "x": 775,
                        "y": 1190
                    },
                    {
                        "x": 775,
                        "y": 1214
                    },
                    {
                        "x": 690,
                        "y": 1214
                    }
                ],
                "prob": 95,
                "word": "825239"
            },
            {
                "pos": [
                    {
                        "x": 832,
                        "y": 1189
                    },
                    {
                        "x": 877,
                        "y": 1192
                    },
                    {
                        "x": 875,
                        "y": 1215
                    },
                    {
                        "x": 830,
                        "y": 1212
                    }
                ],
                "prob": 99,
                "word": "583"
            },
            {
                "pos": [
                    {
                        "x": 414,
                        "y": 1264
                    },
                    {
                        "x": 489,
                        "y": 1264
                    },
                    {
                        "x": 489,
                        "y": 1288
                    },
                    {
                        "x": 414,
                        "y": 1288
                    }
                ],
                "prob": 99,
                "word": "家多宝"
            },
            {
                "pos": [
                    {
                        "x": 692,
                        "y": 1264
                    },
                    {
                        "x": 775,
                        "y": 1264
                    },
                    {
                        "x": 775,
                        "y": 1288
                    },
                    {
                        "x": 692,
                        "y": 1288
                    }
                ],
                "prob": 99,
                "word": "380339"
            },
            {
                "pos": [
                    {
                        "x": 830,
                        "y": 1265
                    },
                    {
                        "x": 876,
                        "y": 1265
                    },
                    {
                        "x": 876,
                        "y": 1286
                    },
                    {
                        "x": 830,
                        "y": 1286
                    }
                ],
                "prob": 99,
                "word": "452"
            },
            {
                "pos": [
                    {
                        "x": 414,
                        "y": 1338
                    },
                    {
                        "x": 535,
                        "y": 1338
                    },
                    {
                        "x": 535,
                        "y": 1362
                    },
                    {
                        "x": 414,
                        "y": 1362
                    }
                ],
                "prob": 99,
                "word": "没落.贵族2"
            },
            {
                "pos": [
                    {
                        "x": 692,
                        "y": 1338
                    },
                    {
                        "x": 775,
                        "y": 1338
                    },
                    {
                        "x": 775,
                        "y": 1362
                    },
                    {
                        "x": 692,
                        "y": 1362
                    }
                ],
                "prob": 99,
                "word": "567940"
            },
            {
                "pos": [
                    {
                        "x": 830,
                        "y": 1337
                    },
                    {
                        "x": 863,
                        "y": 1337
                    },
                    {
                        "x": 863,
                        "y": 1362
                    },
                    {
                        "x": 830,
                        "y": 1362
                    }
                ],
                "prob": 99,
                "word": "17"
            },
            {
                "pos": [
                    {
                        "x": 415,
                        "y": 1412
                    },
                    {
                        "x": 518,
                        "y": 1419
                    },
                    {
                        "x": 516,
                        "y": 1441
                    },
                    {
                        "x": 413,
                        "y": 1434
                    }
                ],
                "prob": 99,
                "word": "Cheng。。"
            },
            {
                "pos": [
                    {
                        "x": 692,
                        "y": 1412
                    },
                    {
                        "x": 775,
                        "y": 1412
                    },
                    {
                        "x": 775,
                        "y": 1436
                    },
                    {
                        "x": 692,
                        "y": 1436
                    }
                ],
                "prob": 99,
                "word": "176340"
            },
            {
                "pos": [
                    {
                        "x": 830,
                        "y": 1412
                    },
                    {
                        "x": 869,
                        "y": 1412
                    },
                    {
                        "x": 869,
                        "y": 1434
                    },
                    {
                        "x": 830,
                        "y": 1434
                    }
                ],
                "prob": 99,
                "word": "28"
            },
            {
                "pos": [
                    {
                        "x": 415,
                        "y": 1486
                    },
                    {
                        "x": 530,
                        "y": 1486
                    },
                    {
                        "x": 530,
                        "y": 1511
                    },
                    {
                        "x": 415,
                        "y": 1511
                    }
                ],
                "prob": 97,
                "word": "那yi脸贼笑"
            },
            {
                "pos": [
                    {
                        "x": 692,
                        "y": 1486
                    },
                    {
                        "x": 775,
                        "y": 1486
                    },
                    {
                        "x": 775,
                        "y": 1508
                    },
                    {
                        "x": 692,
                        "y": 1508
                    }
                ],
                "prob": 99,
                "word": "224413"
            },
            {
                "pos": [
                    {
                        "x": 829,
                        "y": 1487
                    },
                    {
                        "x": 870,
                        "y": 1487
                    },
                    {
                        "x": 870,
                        "y": 1508
                    },
                    {
                        "x": 829,
                        "y": 1508
                    }
                ],
                "prob": 96,
                "word": "-98"
            },
            {
                "pos": [
                    {
                        "x": 692,
                        "y": 1561
                    },
                    {
                        "x": 775,
                        "y": 1561
                    },
                    {
                        "x": 775,
                        "y": 1584
                    },
                    {
                        "x": 692,
                        "y": 1584
                    }
                ],
                "prob": 98,
                "word": "458603"
            },
            {
                "pos": [
                    {
                        "x": 830,
                        "y": 1561
                    },
                    {
                        "x": 883,
                        "y": 1561
                    },
                    {
                        "x": 883,
                        "y": 1582
                    },
                    {
                        "x": 830,
                        "y": 1582
                    }
                ],
                "prob": 99,
                "word": "-119"
            },
            {
                "pos": [
                    {
                        "x": 417,
                        "y": 1635
                    },
                    {
                        "x": 467,
                        "y": 1635
                    },
                    {
                        "x": 467,
                        "y": 1658
                    },
                    {
                        "x": 417,
                        "y": 1658
                    }
                ],
                "prob": 71,
                "word": "LS1"
            },
            {
                "pos": [
                    {
                        "x": 692,
                        "y": 1634
                    },
                    {
                        "x": 763,
                        "y": 1634
                    },
                    {
                        "x": 763,
                        "y": 1656
                    },
                    {
                        "x": 692,
                        "y": 1656
                    }
                ],
                "prob": 99,
                "word": "25590"
            },
            {
                "pos": [
                    {
                        "x": 832,
                        "y": 1634
                    },
                    {
                        "x": 883,
                        "y": 1634
                    },
                    {
                        "x": 883,
                        "y": 1656
                    },
                    {
                        "x": 832,
                        "y": 1656
                    }
                ],
                "prob": 99,
                "word": "-120"
            },
            {
                "pos": [
                    {
                        "x": 415,
                        "y": 1709
                    },
                    {
                        "x": 500,
                        "y": 1709
                    },
                    {
                        "x": 500,
                        "y": 1733
                    },
                    {
                        "x": 415,
                        "y": 1733
                    }
                ],
                "prob": 98,
                "word": "哥就1屏"
            },
            {
                "pos": [
                    {
                        "x": 690,
                        "y": 1709
                    },
                    {
                        "x": 736,
                        "y": 1709
                    },
                    {
                        "x": 736,
                        "y": 1730
                    },
                    {
                        "x": 690,
                        "y": 1730
                    }
                ],
                "prob": 93,
                "word": "828"
            },
            {
                "pos": [
                    {
                        "x": 833,
                        "y": 1709
                    },
                    {
                        "x": 880,
                        "y": 1709
                    },
                    {
                        "x": 880,
                        "y": 1730
                    },
                    {
                        "x": 833,
                        "y": 1730
                    }
                ],
                "prob": 99,
                "word": "-291"
            },
            {
                "pos": [
                    {
                        "x": 415,
                        "y": 1782
                    },
                    {
                        "x": 559,
                        "y": 1784
                    },
                    {
                        "x": 559,
                        "y": 1808
                    },
                    {
                        "x": 415,
                        "y": 1806
                    }
                ],
                "prob": 99,
                "word": "梦想就在前方"
            },
            {
                "pos": [
                    {
                        "x": 692,
                        "y": 1782
                    },
                    {
                        "x": 775,
                        "y": 1782
                    },
                    {
                        "x": 775,
                        "y": 1804
                    },
                    {
                        "x": 692,
                        "y": 1804
                    }
                ],
                "prob": 97,
                "word": "484939"
            },
            {
                "pos": [
                    {
                        "x": 830,
                        "y": 1783
                    },
                    {
                        "x": 884,
                        "y": 1783
                    },
                    {
                        "x": 884,
                        "y": 1804
                    },
                    {
                        "x": 830,
                        "y": 1804
                    }
                ],
                "prob": 99,
                "word": "-396"
            },
            {
                "pos": [
                    {
                        "x": 890,
                        "y": 1888
                    },
                    {
                        "x": 938,
                        "y": 1888
                    },
                    {
                        "x": 938,
                        "y": 1906
                    },
                    {
                        "x": 890,
                        "y": 1906
                    }
                ],
                "prob": 100,
                "word": "看"
            },
            {
                "pos": [
                    {
                        "x": 474,
                        "y": 1898
                    },
                    {
                        "x": 612,
                        "y": 1898
                    },
                    {
                        "x": 612,
                        "y": 1923
                    },
                    {
                        "x": 474,
                        "y": 1923
                    }
                ],
                "prob": 99,
                "word": "分享到微信"
            },
            {
                "pos": [
                    {
                        "x": 689,
                        "y": 1897
                    },
                    {
                        "x": 824,
                        "y": 1897
                    },
                    {
                        "x": 824,
                        "y": 1923
                    },
                    {
                        "x": 689,
                        "y": 1923
                    }
                ],
                "prob": 99,
                "word": "分享到默往"
            },
            {
                "pos": [
                    {
                        "x": 891,
                        "y": 1911
                    },
                    {
                        "x": 941,
                        "y": 1914
                    },
                    {
                        "x": 940,
                        "y": 1935
                    },
                    {
                        "x": 889,
                        "y": 1932
                    }
                ],
                "prob": 99,
                "word": "回放"
            }
        ],
        "prism_tablesInfo": [
            {
                "cellInfos": [
                    {
                        "pos": [
                            {
                                "x": 80,
                                "y": 348
                            },
                            {
                                "x": 128,
                                "y": 348
                            },
                            {
                                "x": 128,
                                "y": 460
                            },
                            {
                                "x": 80,
                                "y": 460
                            }
                        ],
                        "tableCellId": 0,
                        "word": "",
                        "xec": 0,
                        "xsc": 0,
                        "yec": 1,
                        "ysc": 0
                    },
                    {
                        "pos": [
                            {
                                "x": 80,
                                "y": 460
                            },
                            {
                                "x": 128,
                                "y": 460
                            },
                            {
                                "x": 128,
                                "y": 532
                            },
                            {
                                "x": 76,
                                "y": 524
                            }
                        ],
                        "tableCellId": 1,
                        "word": "",
                        "xec": 0,
                        "xsc": 0,
                        "yec": 3,
                        "ysc": 2
                    },
                    {
                        "pos": [
                            {
                                "x": 76,
                                "y": 524
                            },
                            {
                                "x": 128,
                                "y": 532
                            },
                            {
                                "x": 128,
                                "y": 656
                            },
                            {
                                "x": 80,
                                "y": 648
                            }
                        ],
                        "tableCellId": 2,
                        "word": "房主",
                        "xec": 0,
                        "xsc": 0,
                        "yec": 5,
                        "ysc": 4
                    },
                    {
                        "pos": [
                            {
                                "x": 80,
                                "y": 648
                            },
                            {
                                "x": 128,
                                "y": 656
                            },
                            {
                                "x": 128,
                                "y": 708
                            },
                            {
                                "x": 80,
                                "y": 708
                            }
                        ],
                        "tableCellId": 3,
                        "word": "",
                        "xec": 0,
                        "xsc": 0,
                        "yec": 6,
                        "ysc": 6
                    }
                ],
                "tableId": 0,
                "xCellSize": 1,
                "yCellSize": 7
            }
        ],
        "orgHeight": 1136,
        "orgWidth": 640
    }
    go(result)
